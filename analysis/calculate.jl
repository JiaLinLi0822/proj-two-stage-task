using Random, LinearAlgebra, Statistics, Distributions, Printf

X = [7.069272730605811 7.015077541031613; 7.6756819416735755 7.733811832580652; 7.083633596579232 8.90819324575449; 6.738499553736004 8.395769454410871; 6.777980215368997 7.893308221068312; 7.024909644844849 8.421847464105108; 8.185431872228255 7.164173414635743; 6.669869808515745 7.645537799011646; 7.677072895987298 8.312943268292987; 6.889889602709568 7.265634575522043; 6.953963989064212 7.424340068122679; 7.16184926086124 8.752943813599678; 7.171881811857493 7.511138006541362; 7.110935252548338 7.726782831439142; 7.27121225101415 7.554488279080259; 7.139099487799081 8.48121216231494; 6.719366918796005 9.124160609326745; 7.079431178604182 8.56317808520579; 6.8290290871337165 8.987483400687744; 7.43502080521152 7.687214536088559; 6.978486742408535 7.413544020176088; 7.45257237225608 7.764420401579366; 7.474371063247918 7.893681384228029; 6.783656933513359 7.653159449582026; 7.884686809012478 8.236233266287703; 7.478335293081783 7.789575870840755; 6.640258726200169 7.72324971605507; 7.628173680637685 6.886830850827595; 7.746859506805311 7.63157373438267; 7.150931210609046 8.465540457438017; 6.822516477778664 8.075362696079095; 7.44966842061702 7.658837806734192; 7.611987279663426 7.112566184547697; 7.159519692809915 7.648879421128094; 7.514414383106831 8.16060194933155; 7.039040498503813 6.686226633942082; 7.506752738956924 7.825761725675509; 7.214719967628641 7.5518660736563215; 8.302586340753152 6.683727547833617; 6.54577050387942 7.287076917828711; 7.538650904635879 9.12503223115596; 8.061894660289575 7.967035077416807; 7.248001078714121 8.78863809697558; 7.050376580577567 7.894427293054867; 7.011478126267842 7.948841898880461; 7.087818428117231 7.601548735036079; 7.530100614679315 8.88159918922081; 7.806815603813335 7.867217742580559; 7.257914117266308 8.000447736223235; 6.887851474692738 7.893308221068312; 7.731620572431658 7.073517965245374; 6.820336148417771 8.164309044390656; 7.011478126267842 6.788175219488921; 6.911042837783817 7.67521785995786; 7.611987279663426 7.714808196514707; 6.605694281832044 7.991014635137055; 8.123051620016023 7.20436708894844; 7.131133177834817 8.469953348315325; 6.862018066995552 7.828951148474712; 6.972880786012901 7.092817218121136; 7.446172510408251 7.867600767977132; 6.96157370285754 8.362243885480359; 6.678710560920613 7.337127630383318; 8.024958012429055 8.913320567452612; 7.272601822397629 7.157963627031775; 7.555535239004944 7.289810480127041; 6.80936261883799 8.254344981741152; 7.395901438196007 7.726782831439142; 6.677452371465952 8.168002447637214; 7.713915456073734 7.369785308876455; 7.608519857732707 7.78126082752048; 6.746756333429143 7.923092101175711; 7.178006031458616 7.8843102736335595; 7.155624978909746 7.591000076758137; 7.04950912207477 7.644580995260938; 7.453152152001318 7.0538389092717635; 7.245150638501413 7.464677710945658; 7.780007586145049 8.273666551401968; 7.072670358854798 6.7549454966249085; 7.96634142605988 7.802737781960635; 7.293896863755488 8.419424444937166; 7.07436485380775 7.58695208840285; 7.130333045270181 7.720147966931828; 7.389744893915981 8.239142710906963; 7.031116477718198 9.108561542056096; 8.394639713239718 9.01009428253669; 6.860970719430016 8.62627949208416; 6.562857805772567 8.265211017921683; 8.277740610113126 7.369155106920188; 7.74599493835177 8.754680255945662; 6.79491459958088 8.058103537480065; 7.65505582019436 7.891440313646202; 7.456623789122235 7.406281353703958; 6.934682435800859 7.68169548661714; 6.851494899288792 7.083633596579232; 6.701091399801533 7.187122606109329; 7.687214536088559 7.316078278591944; 7.92887185235136 7.472667285019041; 7.577783754194017 8.95625978882476; 6.719366918796005 8.19375763800859; 7.426128131879751 8.479136737749778; 7.143848988846975 8.265468299442349; 7.841608078501701 8.85327863449247; 8.123644688316183 8.24624839109165; 8.02397594907098 7.230775273379486; 7.537053284084506 9.069616658653835; 6.938568603447526 7.409313877451036; 7.19390590593215 7.672894215293931; 6.899010120054956 7.8088482959078; 6.923916941640993 7.708991086455552; 7.179531243928579 8.870001685888463; 7.368524507558957 8.404761728484834; 6.491168001342228 8.344574719566165; 6.67240372323348 7.655529351470145; 7.454889477094058 7.556581103950843; 6.982206663145347 8.414782314349745; 6.567084396621022 8.370152203766148; 7.107665386975503 8.368993130858385; 7.610007368151305 7.960425881774265; 6.704773320859023 7.340376933246467; 7.1493617124955025 8.708027242034312; 6.891923585208249 8.14389308899768; 8.040541261111438 7.855270597238831; 7.418956613410037 8.605806994772186; 7.432657147182941 7.214719967628641; 8.454315789855299 8.770950207066956; 7.575734880657452 8.495211958305868; 6.509205656809709 7.234388534577346; 7.317406923803033 9.129162091398308; 7.689505180349308 7.3583804585337775; 6.655817330460024 7.687673084897113; 6.840859815770849 7.737307891982808; 7.529563786357117 7.776657910211277; 6.477422982499261 8.84062259151943; 7.104384794296019 8.63413907119985; 7.570078736531723 7.5182233042323094; 6.879657167225131 7.543428508793246; 7.671031404203455 7.995742308563418; 7.3312521458533695 8.231986178476097; 7.490134555135115 7.403239605776968; 6.682475658833934 7.036406128765591; 7.3006706129015235 8.654917052879949; 7.233666926035562 7.252261562298856; 7.247289230018639 7.8447474375426305; 8.013771083451461 8.729444512178997; 7.197654618043022 8.174221912948925; 7.436200542442093 8.236498111318701; 6.947257653186374 7.465822994271195; 6.822516477778664 9.111767100637229; 8.032455294015051 7.947782125059522; 7.127126097481339 7.960425881774265; 6.9491783428240295 8.44511548860099; 7.143848988846975 7.609015940433665; 6.681222200643526 8.65700608358039; 7.179531243928579 8.687154164770089; 6.8493769117427314 8.531351087494373; 6.99236566391665 9.095747700675346; 7.3013454710355825 7.961472347391585; 8.056836629222069 7.862225015754498; 7.9011155530504125 8.171964762237337; 6.995118482094531 8.107205763642693; 8.764879953917083 8.309502863800947; 7.573681800618051 7.812092033418274; 7.017768625290826 7.298643301587812; 6.688719490184906 9.050323365204989; 6.5796580302899885 7.450249885971482; 7.307398786911515 8.390562044387991; 6.877598055534834 8.124533631793705; 7.135124265557779 7.601048933189294; 6.660950199538167 8.87937396603843; 7.9666883118823675 7.575222005681519; 7.418956613410037 8.265982663987451; 6.7181588871270215 7.264935173536847; 8.555893186086486 6.882737906631773; 7.9011155530504125 7.4583550985189495; 6.9170053337586435 7.85371858089788; 8.20720905818518 8.216977694378713; 7.289810480127041 8.105395968341272; 7.100268860809957 7.20436708894844; 7.427318400644377 7.760591901531638; 8.461108006606988 7.6030466435107655; 7.115820090354519 7.169575525306281; 6.998777157834979 7.589484000735027; 6.831190565547809 7.737307891982808; 7.2808989441436625 7.100268860809957; 7.542368789809345 8.798045942360051; 7.625250119350401 8.219943621071398; 6.507714883602794 7.263534900364218; 7.57265367775517 7.983198890935764; 7.7550358401125665 7.583396606701479; 7.148576038724518 9.190575626774967; 7.671963243506775 8.296370187734992; 7.748586404502634 8.576271765775799; 7.528489264384482 8.488648226630275; 7.122296309489012 8.10297780163901; 6.79491459958088 7.657421237434956; 7.131133177834817 8.345049971658284; 6.895979180867303 7.957629941163186; 7.4450044858564475 8.90575530796826; 7.514414383106831 7.943176749064593; 8.363644023352833 7.073517965245374; 7.2351096227757035 7.136716251242769; 6.907047997667667 7.818950236925836; 7.61149266916876 7.556058308207073; 8.18236163938568 8.2025627087664; 6.850436466249563 8.503964672859967; 7.7686571701038245 8.711326871048952; 6.744404201874972 7.011478126267842; 7.209556925990828 7.849827968918767; 7.440318696841808 7.312081718219559; 7.969113149238451 7.4918088561024385; 7.164946933732795 7.788333013468556; 6.52252354178386 9.024046090601509; 7.118253590185007 8.033104582927033; 7.16880557961558 8.253564299519455; 7.254385016473405 6.739683275847525; 6.919973302764126 8.439943389842826; 6.815961176153034 6.9443696839996925; 6.7479303277582146 7.800283083162463; 6.860970719430016 8.936336717795268; 6.9010256545191195 6.906046789094097; 7.868748964702043 7.410524316690336; 7.457201225366538 6.97941802069157; 7.16339929674369 8.63538378289935; 8.010456851370913 6.867238413686475; 6.709661555412783 7.531173407542528; 6.935655394469864 7.989320748997866; 8.378458104457051 6.953008690255467; 6.709661555412783 8.249128884403493; 7.117443081388092 7.654582064580471; 7.291855759256207 8.201192016727223; 7.847095505975523 8.891826922277653; 7.650783917914281 7.99607914579659; 7.194656773424656 7.64170507887464; 6.757272992572864 8.547973183381602; 7.752031279037884 7.354549752875985; 6.965356953942359 8.362243885480359; 6.948218459136217 7.486777519808647; 7.383550211679256 7.931390026826124; 6.8290290871337165 8.823102086817316; 7.58695208840285 7.123102895813842; 7.357743025772553 7.5045528725537185; 6.975687692548963 7.656475741856547; 7.4123372327942345 7.610997813913485; 7.185608936976769 7.157184685196989; 8.29161993294025 6.730174031647359; 7.716591289991809 9.15009055784026; 7.928151207681022 8.813928108251654; 7.714808196514707 7.177242551983284; 8.526211002211658 8.626100145396023; 6.929803391865893 8.625920766536883; 7.344908292541408 7.386032691359744; 7.318070585007621 8.630395613171977; 7.637857612457499 7.965994419865861; 7.601048933189294 7.178006031458616; 7.380438420594824 8.31269791726248; 7.952014498237617 8.961147074202984; 7.607030131330155 8.302338435118712; 7.496260001991039 8.367368168472526; 6.7870475604510085 7.8380644788742675; 7.24586401063603 8.538816311344963; 6.654529985983008 8.203110459951288; 7.034646018854383 8.751995390806206; 7.6526847944860545 7.310745974087242; 7.968074653125344 6.908048204825173; 6.77911813993538 7.656475741856547; 6.673668276881243 8.07068511710975; 7.528489264384482 8.576271765775799; 7.2058526499773095 7.183334128599127; 7.978068557474842 8.523233505681947; 7.107665386975503 7.941755432692133; 7.541307946629682 7.796589699955016; 6.793794518957991 7.765269192517758; 6.840859815770849 8.22048193664035; 7.349419211208302 8.800610126399397; 7.378566687355199 8.793656513676682; 7.187878582343894 7.840821696387001; 6.957776084411412 7.87485051392983; 7.857594114659966 7.792469878296547; 7.362196545866426 7.357743025772553; 7.911797868830529 7.583905307280564; 7.091985819797748 8.141566351956408; 6.686226633942082 8.719691973432212; 7.797000750145856 7.685837626709376; 7.721921572890781 8.215356200792856; 7.910331212786291 8.622686432640636; 6.899010120054956 9.149984342015413; 6.609744001830222 7.37981489869899; 7.384171409592012 8.587519860499569; 7.079431178604182 8.205025229796993; 7.139892639472044 6.919973302764126; 7.0936479257955165 7.299319528794215; 7.932467306294938 7.35198777234576; 7.763995735789931 8.631288184596848; 7.654582064580471 7.8970336011523035; 7.3053850836140235 6.938568603447526; 8.543112947099903 7.27675898852462; 6.984987550693039 8.398700822211035; 6.76422315244852 7.838853031351555; 6.924900426097846 8.177878951376394; 6.822516477778664 7.872185665871467; 7.087818428117231 8.773584726710617; 6.92784508930203 7.477769935776377; 6.500227498151487 8.497662292823469; 7.9183713308453605 7.610007368151305; 6.725385283515049 7.735124287589329; 6.835499556700159 7.512231325235191; 7.668697999930818 7.3468440355711335; 7.002422496448653 8.486794388035; 6.971005128341921 7.026686960248051; 6.974752932177539 8.559542269350866; 7.988981627187626 8.203384223073042; 7.620358442818087 7.64026401313746; 6.969125945967068 7.613963278870692; 7.612975767338588 7.33907847878256; 6.891923585208249 7.46353111444212]



@inline _scotts_factor(n::Real, d::Integer) = float(n)^(-1.0 / (d + 4))
@inline _silverman_factor(n::Real, d::Integer) = (float(n) * (d + 2) / 4.0)^(-1.0 / (d + 4))

n = size(X, 1)
println("n = $n")

cov_X = cov(X)
println("cov_X = $cov_X")

μ = vec(mean(X, dims=1))
XC = X .- μ'
Σ  = (XC' * XC) / (n - 1)
println("Σ = $Σ")

d = 2
factor1 = _scotts_factor(n, d)
H1 = factor1^2 * cov_X

println("H1 = $H1")

println("="^60)

factor2 = _silverman_factor(n, d)
H2 = factor2^2 * cov_X

println("H2 = $H2")

# # 对X中的每一个样本（每一行）进行指数化
# x = exp.(X)
# println("指数化后的X（每个样本）：")
# println(x)




